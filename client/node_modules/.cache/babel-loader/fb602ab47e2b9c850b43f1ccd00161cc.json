{"ast":null,"code":"import _slicedToArray from \"/Users/elijahchen/blockchain-developer-bootcamp/blockchain-developer-bootcamp-final-project/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/elijahchen/blockchain-developer-bootcamp/blockchain-developer-bootcamp-final-project/client/src/App.js\";\nimport React, { Component } from \"react\";\nimport { useEffect, useState } from \"react\";\nimport SimpleStorageContract from \"./contracts/SimpleStorage.json\";\nimport CarSharingContract from \"./contracts/CarSharing.json\";\nimport getWeb3 from \"./getWeb3\";\nimport \"./App.css\"; // interactions\n\nexport const loadRegistrationStatus = async () => {\n  const status = await CarSharingContract.methods.getRegistrationStatus(accounts[0]).call();\n  return status;\n};\nexport const registerUser = async () => {\n  await CarSharingContract.methods.registerDriver(this.state.userName, this.state.userId).send({\n    from: accounts[0]\n  });\n  let response = await CarSharingContract.methods.getRegistrationStatus(accounts[0]).call();\n\n  if (response == true) {\n    this.setState({\n      registrationStatus: \"You are registered\"\n    });\n  }\n};\nexport const connectWallet = async () => {\n  if (window.ethereum) {\n    try {\n      const addressArray = await window.ethereum.request({\n        method: \"eth_requestAccounts\"\n      });\n      const obj = {\n        status: \"👆🏽 Write a message in the text-field above.\",\n        address: addressArray[0]\n      };\n      return obj;\n    } catch (err) {\n      return {\n        address: \"\",\n        status: \"😥 \" + err.message\n      };\n    }\n  } else {\n    return {\n      address: \"\",\n      status: React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 48\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 49\n        },\n        __self: this\n      }, \" \", \"\\uD83E\\uDD8A\", \" \", React.createElement(\"a\", {\n        target: \"_blank\",\n        href: \"https://metamask.io/download.html\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 52\n        },\n        __self: this\n      }, \"You must install Metamask, a virtual Ethereum wallet, in your browser.\")))\n    };\n  }\n};\nexport const getCurrentWalletConnected = async () => {\n  if (window.ethereum) {\n    try {\n      const addressArray = await window.ethereum.request({\n        method: \"eth_accounts\"\n      });\n\n      if (addressArray.length > 0) {\n        return {\n          address: addressArray[0],\n          status: \"👆🏽 Write a message in the text-field above.\"\n        };\n      } else {\n        return {\n          address: \"\",\n          status: \"🦊 Connect to Metamask using the top right button.\"\n        };\n      }\n    } catch (err) {\n      return {\n        address: \"\",\n        status: \"😥 \" + err.message\n      };\n    }\n  } else {\n    return {\n      address: \"\",\n      status: React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91\n        },\n        __self: this\n      }, \" \", \"\\uD83E\\uDD8A\", \" \", React.createElement(\"a\", {\n        target: \"_blank\",\n        href: \"https://metamask.io/download.html\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94\n        },\n        __self: this\n      }, \"You must install Metamask, a virtual Ethereum wallet, in your browser.\")))\n    };\n  }\n}; // ------------------------------\n\nconst HelloWorld = () => {\n  //state variables\n  const _useState = useState(\"\"),\n        _useState2 = _slicedToArray(_useState, 2),\n        walletAddress = _useState2[0],\n        setWallet = _useState2[1];\n\n  const _useState3 = useState(\"\"),\n        _useState4 = _slicedToArray(_useState3, 2),\n        status = _useState4[0],\n        setStatus = _useState4[1];\n\n  const _useState5 = useState(\"No connection to the network.\"),\n        _useState6 = _slicedToArray(_useState5, 2),\n        message = _useState6[0],\n        setMessage = _useState6[1]; //default message\n\n\n  const _useState7 = useState(\"\"),\n        _useState8 = _slicedToArray(_useState7, 2),\n        newMessage = _useState8[0],\n        setNewMessage = _useState8[1]; //called only once\n\n\n  useEffect(async () => {\n    const message = await loadCurrentMessage();\n    setMessage(message);\n    addSmartContractListener();\n\n    const _ref = await getCurrentWalletConnected(),\n          address = _ref.address,\n          status = _ref.status;\n\n    setWallet(address);\n    setStatus(status);\n    addWalletListener();\n  }, []);\n\n  function addSmartContractListener() {\n    CarSharingContract.events.UserRegistered({}, (error, data) => {\n      if (error) {\n        setStatus(\"😥 \" + error.message);\n      } else {\n        setMessage(data.returnValues[1]);\n        setNewMessage(\"\");\n        setStatus(\"🎉 Your message has been updated!\");\n      }\n    });\n  }\n\n  function addWalletListener() {\n    if (window.ethereum) {\n      window.ethereum.on(\"accountsChanged\", accounts => {\n        if (accounts.length > 0) {\n          setWallet(accounts[0]);\n          setStatus(\"👆🏽 Write a message in the text-field above.\");\n        } else {\n          setWallet(\"\");\n          setStatus(\"🦊 Connect to Metamask using the top right button.\");\n        }\n      });\n    } else {\n      setStatus(React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, \" \", \"\\uD83E\\uDD8A\", \" \", React.createElement(\"a\", {\n        target: \"_blank\",\n        href: \"https://metamask.io/download.html\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156\n        },\n        __self: this\n      }, \"You must install Metamask, a virtual Ethereum wallet, in your browser.\")));\n    }\n  }\n\n  const connectWalletPressed = async () => {\n    const walletResponse = await connectWallet();\n    setStatus(walletResponse.status);\n    setWallet(walletResponse.address);\n  };\n\n  const onUpdatePressed = async () => {\n    const _ref2 = await updateMessage(walletAddress, newMessage),\n          status = _ref2.status;\n\n    setStatus(status);\n  }; //the UI of our component\n\n\n  return React.createElement(\"div\", {\n    id: \"container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178\n    },\n    __self: this\n  }, React.createElement(\"img\", {\n    id: \"logo\",\n    src: alchemylogo,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179\n    },\n    __self: this\n  }), React.createElement(\"button\", {\n    id: \"walletButton\",\n    onClick: connectWalletPressed,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180\n    },\n    __self: this\n  }, walletAddress.length > 0 ? \"Connected: \" + String(walletAddress).substring(0, 6) + \"...\" + String(walletAddress).substring(38) : React.createElement(\"span\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187\n    },\n    __self: this\n  }, \"Connect Wallet\")), React.createElement(\"h2\", {\n    style: {\n      paddingTop: \"50px\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191\n    },\n    __self: this\n  }, \"Current Message:\"), React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192\n    },\n    __self: this\n  }, message), React.createElement(\"h2\", {\n    style: {\n      paddingTop: \"18px\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194\n    },\n    __self: this\n  }, \"New Message:\"), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196\n    },\n    __self: this\n  }, React.createElement(\"input\", {\n    type: \"text\",\n    placeholder: \"Update the message in your smart contract.\",\n    onChange: e => setNewMessage(e.target.value),\n    value: newMessage,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197\n    },\n    __self: this\n  }), React.createElement(\"p\", {\n    id: \"status\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203\n    },\n    __self: this\n  }, status), React.createElement(\"button\", {\n    id: \"publish\",\n    onClick: onUpdatePressed,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205\n    },\n    __self: this\n  }, \"Update\")));\n};\n\nexport default HelloWorld;","map":{"version":3,"sources":["/Users/elijahchen/blockchain-developer-bootcamp/blockchain-developer-bootcamp-final-project/client/src/App.js"],"names":["React","Component","useEffect","useState","SimpleStorageContract","CarSharingContract","getWeb3","loadRegistrationStatus","status","methods","getRegistrationStatus","accounts","call","registerUser","registerDriver","state","userName","userId","send","from","response","setState","registrationStatus","connectWallet","window","ethereum","addressArray","request","method","obj","address","err","message","getCurrentWalletConnected","length","HelloWorld","walletAddress","setWallet","setStatus","setMessage","newMessage","setNewMessage","loadCurrentMessage","addSmartContractListener","addWalletListener","events","UserRegistered","error","data","returnValues","on","connectWalletPressed","walletResponse","onUpdatePressed","updateMessage","alchemylogo","String","substring","paddingTop","e","target","value"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { useEffect, useState } from \"react\";\nimport SimpleStorageContract from \"./contracts/SimpleStorage.json\";\nimport CarSharingContract from \"./contracts/CarSharing.json\";\nimport getWeb3 from \"./getWeb3\";\n\nimport \"./App.css\";\n\n// interactions\n\nexport const loadRegistrationStatus = async () => {\n  const status = await CarSharingContract.methods.getRegistrationStatus(accounts[0]).call();\n  return status;\n};\n\n\nexport const registerUser = async () => {\n  await CarSharingContract.methods.registerDriver(this.state.userName, this.state.userId).send({ from: accounts[0] });\n\n  let response = await CarSharingContract.methods.getRegistrationStatus(accounts[0]).call();\n  if(response == true){\n    this.setState({ registrationStatus: \"You are registered\"});\n  }\n  \n};\n\nexport const connectWallet = async () => {\n  if (window.ethereum) {\n    try {\n      const addressArray = await window.ethereum.request({\n        method: \"eth_requestAccounts\",\n      });\n      const obj = {\n        status: \"👆🏽 Write a message in the text-field above.\",\n        address: addressArray[0],\n      };\n      return obj;\n    } catch (err) {\n      return {\n        address: \"\",\n        status: \"😥 \" + err.message,\n      };\n    }\n  } else {\n    return {\n      address: \"\",\n      status: (\n        <span>\n          <p>\n            {\" \"}\n            🦊{\" \"}\n            <a target=\"_blank\" href={`https://metamask.io/download.html`}>\n              You must install Metamask, a virtual Ethereum wallet, in your\n              browser.\n            </a>\n          </p>\n        </span>\n      ),\n    };\n  }\n};\n\nexport const getCurrentWalletConnected = async () => {\n  if (window.ethereum) {\n    try {\n      const addressArray = await window.ethereum.request({\n        method: \"eth_accounts\",\n      });\n      if (addressArray.length > 0) {\n        return {\n          address: addressArray[0],\n          status: \"👆🏽 Write a message in the text-field above.\",\n        };\n      } else {\n        return {\n          address: \"\",\n          status: \"🦊 Connect to Metamask using the top right button.\",\n        };\n      }\n    } catch (err) {\n      return {\n        address: \"\",\n        status: \"😥 \" + err.message,\n      };\n    }\n  } else {\n    return {\n      address: \"\",\n      status: (\n        <span>\n          <p>\n            {\" \"}\n            🦊{\" \"}\n            <a target=\"_blank\" href={`https://metamask.io/download.html`}>\n              You must install Metamask, a virtual Ethereum wallet, in your\n              browser.\n            </a>\n          </p>\n        </span>\n      ),\n    };\n  }\n};\n\n// ------------------------------\n\nconst HelloWorld = () => {\n  //state variables\n  const [walletAddress, setWallet] = useState(\"\");\n  const [status, setStatus] = useState(\"\");\n  const [message, setMessage] = useState(\"No connection to the network.\"); //default message\n  const [newMessage, setNewMessage] = useState(\"\");\n\n  //called only once\n  useEffect(async () => {\n    const message = await loadCurrentMessage();\n    setMessage(message);\n    addSmartContractListener();\n\n    const { address, status } = await getCurrentWalletConnected();\n\n    setWallet(address);\n    setStatus(status);\n\n    addWalletListener();\n  }, []);\n\n  function addSmartContractListener() {\n    CarSharingContract.events.UserRegistered({}, (error, data) => {\n      if (error) {\n        setStatus(\"😥 \" + error.message);\n      } else {\n        setMessage(data.returnValues[1]);\n        setNewMessage(\"\");\n        setStatus(\"🎉 Your message has been updated!\");\n      }\n    });\n  }\n\n  function addWalletListener() {\n    if (window.ethereum) {\n      window.ethereum.on(\"accountsChanged\", (accounts) => {\n        if (accounts.length > 0) {\n          setWallet(accounts[0]);\n          setStatus(\"👆🏽 Write a message in the text-field above.\");\n        } else {\n          setWallet(\"\");\n          setStatus(\"🦊 Connect to Metamask using the top right button.\");\n        }\n      });\n    } else {\n      setStatus(\n        <p>\n          {\" \"}\n          🦊{\" \"}\n          <a target=\"_blank\" href={`https://metamask.io/download.html`}>\n            You must install Metamask, a virtual Ethereum wallet, in your\n            browser.\n          </a>\n        </p>\n      );\n    }\n  }\n\n  const connectWalletPressed = async () => {\n    const walletResponse = await connectWallet();\n    setStatus(walletResponse.status);\n    setWallet(walletResponse.address);\n  };\n\n  const onUpdatePressed = async () => {\n    const { status } = await updateMessage(walletAddress, newMessage);\n    setStatus(status);\n  };\n\n  //the UI of our component\n  return (\n    <div id=\"container\">\n      <img id=\"logo\" src={alchemylogo}></img>\n      <button id=\"walletButton\" onClick={connectWalletPressed}>\n        {walletAddress.length > 0 ? (\n          \"Connected: \" +\n          String(walletAddress).substring(0, 6) +\n          \"...\" +\n          String(walletAddress).substring(38)\n        ) : (\n          <span>Connect Wallet</span>\n        )}\n      </button>\n\n      <h2 style={{ paddingTop: \"50px\" }}>Current Message:</h2>\n      <p>{message}</p>\n\n      <h2 style={{ paddingTop: \"18px\" }}>New Message:</h2>\n\n      <div>\n        <input\n          type=\"text\"\n          placeholder=\"Update the message in your smart contract.\"\n          onChange={(e) => setNewMessage(e.target.value)}\n          value={newMessage}\n        />\n        <p id=\"status\">{status}</p>\n\n        <button id=\"publish\" onClick={onUpdatePressed}>\n          Update\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default HelloWorld;"]},"metadata":{},"sourceType":"module"}