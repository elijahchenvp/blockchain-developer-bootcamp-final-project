{"ast":null,"code":"import _regeneratorRuntime from\"/Users/elijahchen/blockchain-developer-bootcamp/blockchain-developer-bootcamp-final-project/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/elijahchen/blockchain-developer-bootcamp/blockchain-developer-bootcamp-final-project/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/elijahchen/blockchain-developer-bootcamp/blockchain-developer-bootcamp-final-project/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";var _this=this;import React,{Component}from\"react\";import{useEffect,useState}from\"react\";import SimpleStorageContract from\"./contracts/SimpleStorage.json\";import CarSharingContract from\"./contracts/CarSharing.json\";import getWeb3 from\"./getWeb3\";import\"./App.css\";var App=function App(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),message=_useState2[0],setMessage=_useState2[1];//default message\nvar _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),walletAddress=_useState4[0],setWallet=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),status=_useState6[0],setStatus=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),regStatus=_useState8[0],setRegStatus=_useState8[1];var _useState9=useState(\"User Registered üî¥\"),_useState10=_slicedToArray(_useState9,2),registrationStatus=_useState10[0],setRegistrationStatus=_useState10[1];var _useState11=useState(\"Car Reserved üî¥\"),_useState12=_slicedToArray(_useState11,2),rentStatus=_useState12[0],setRentStatus=_useState12[1];var _useState13=useState(\"0\"),_useState14=_slicedToArray(_useState13,2),userRegistered=_useState14[0],setUserRegistered=_useState14[1];var _useState15=useState(\"0\"),_useState16=_slicedToArray(_useState15,2),userRented=_useState16[0],setUserRented=_useState16[1];var _useState17=useState(\"\"),_useState18=_slicedToArray(_useState17,2),contract=_useState18[0],setContract=_useState18[1];var _useState19=useState(\"test\"),_useState20=_slicedToArray(_useState19,2),content=_useState20[0],setContent=_useState20[1];var _useState21=useState(\"\"),_useState22=_slicedToArray(_useState21,2),userName=_useState22[0],setUserName=_useState22[1];var _useState23=useState(\"\"),_useState24=_slicedToArray(_useState23,2),license=_useState24[0],setLicense=_useState24[1];var _useState25=useState(\"\"),_useState26=_slicedToArray(_useState25,2),plateNo=_useState26[0],setPlateNo=_useState26[1];//state = { message: null, userName: null, userId: null, rentStatus: null, web3: null, accounts: null, contract: null };\nuseEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return whenWalletConnected();case 2:case\"end\":return _context.stop();}}},_callee);})),[]);var whenWalletConnected=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var web3,accounts,networkId,deployedNetwork,instance;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return getWeb3();case 2:web3=_context2.sent;_context2.next=5;return web3.eth.getAccounts();case 5:accounts=_context2.sent;_context2.next=8;return web3.eth.net.getId();case 8:networkId=_context2.sent;deployedNetwork=CarSharingContract.networks[networkId];instance=new web3.eth.Contract(CarSharingContract.abi,deployedNetwork&&deployedNetwork.address);setContract(instance);// Set web3, accounts, and contract to the state, and then proceed with an\n// example of interacting with the contract's methods.\n//this.setState({ web3, accounts, contract: instance }, this.startApp);\ninstance.events.UserRegistered({},function(error,data){if(error){setMessage(error.message);}else{setRegistrationStatus(\"User Registered üü¢\");setUserRegistered(\"1\");}});instance.events.CarReserved({},function(error,data){if(error){setMessage(error.message);}else{setRentStatus(\"Car Reserved üü¢\");setUserRented(\"1\");}});instance.events.CarReleased({},function(error,data){if(error){setMessage(error.message);}else{setRentStatus(\"Car Reserved üî¥\");}});case 15:case\"end\":return _context2.stop();}}},_callee2);}));return function whenWalletConnected(){return _ref2.apply(this,arguments);};}();var componentDidMount=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var web3,accounts,networkId,deployedNetwork,instance;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return getWeb3();case 3:web3=_context3.sent;_context3.next=6;return web3.eth.getAccounts();case 6:accounts=_context3.sent;_context3.next=9;return web3.eth.net.getId();case 9:networkId=_context3.sent;deployedNetwork=CarSharingContract.networks[networkId];instance=new web3.eth.Contract(CarSharingContract.abi,deployedNetwork&&deployedNetwork.address);// Set web3, accounts, and contract to the state, and then proceed with an\n// example of interacting with the contract's methods.\n//this.setState({ web3, accounts, contract: instance }, this.startApp);\ninstance.events.UserRegistered({},function(error,data){if(error){alert(error.message);}else{_this.setState({registrationStatus:\"You are registered\"});}});_context3.next=19;break;case 15:_context3.prev=15;_context3.t0=_context3[\"catch\"](0);// Catch any errors for any of the above operations.\nalert(\"Failed to load web3, accounts, or contract. Check console for details.\");console.error(_context3.t0);case 19:case\"end\":return _context3.stop();}}},_callee3,null,[[0,15]]);}));return function componentDidMount(){return _ref3.apply(this,arguments);};}();var runExample=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var _this$state,accounts,contract,response;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_this$state=_this.state,accounts=_this$state.accounts,contract=_this$state.contract;// Stores a given value, 5 by default.\n_context4.next=3;return contract.methods.set(5).send({from:accounts[0]});case 3:_context4.next=5;return contract.methods.get().call();case 5:response=_context4.sent;// Update state with the result.\n_this.setState({storageValue:response});case 7:case\"end\":return _context4.stop();}}},_callee4);}));return function runExample(){return _ref4.apply(this,arguments);};}();var rentCar=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return contract.methods.rentCar(10,plateNo).send({from:walletAddress});case 2:case\"end\":return _context5.stop();}}},_callee5);}));return function rentCar(){return _ref5.apply(this,arguments);};}();var unrentCar=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return contract.methods.unrentCar(plateNo).send({from:walletAddress});case 2:case\"end\":return _context6.stop();}}},_callee6);}));return function unrentCar(){return _ref6.apply(this,arguments);};}();var registerUser=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(){return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:if(!(userRegistered==\"0\")){_context7.next=5;break;}_context7.next=3;return contract.methods.registerDriver(userName,license).send({from:walletAddress});case 3:_context7.next=6;break;case 5:setRegStatus(\"You are already registered!\");case 6:case\"end\":return _context7.stop();}}},_callee7);}));return function registerUser(){return _ref7.apply(this,arguments);};}();var getUserStatus=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(address){var response;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.next=2;return contract.methods.getRegistrationStatus(address).call();case 2:response=_context8.sent;if(response){setRegistrationStatus(\"User Registered üü¢\");setUserRegistered(\"1\");}else{setRegistrationStatus(\"User Registered üî¥\");setContent('<div>'+'<h3 style={{ paddingTop: \"18px\" }}>User Registration</h3>'+' <h3 style={{ paddingTop: \"18px\" }}>Name:</h3>'+'   <input'+'     type=\"text\"'+'     placeholder=\"e.g. John Wick\"'+'   />'+'  <h3 style={{ paddingTop: \"18px\" }}>License:</h3>'+'   <input'+'     type=\"text\"'+'     placeholder=\"e.g. ID12345\"'+'   />'+' </div> '+' <button id=\"publish\" style={{ float: \"right\"}}>'+'     Register'+'   </button>');}_context8.next=6;return contract.methods.getRentStatus(address).call();case 6:response=_context8.sent;if(response){setRentStatus(\"Car Reserved üü¢\");}else{setRentStatus(\"Car Reserved üî¥\");}case 8:case\"end\":return _context8.stop();}}},_callee8);}));return function getUserStatus(_x){return _ref8.apply(this,arguments);};}();// getCurrentWalletConnected = async () => {\n//   if (window.ethereum) {\n//     try {\n//       const addressArray = await window.ethereum.request({\n//         method: \"eth_accounts\",\n//       });\n//       if (addressArray.length > 0) {\n//         return {\n//           address: addressArray[0],\n//           status: \"üëÜüèΩ Write a message in the text-field above.\",\n//         };\n//       } else {\n//         return {\n//           address: \"\",\n//           status: \"ü¶ä Connect to Metamask using the top right button.\",\n//         };\n//       }\n//     } catch (err) {\n//       return {\n//         address: \"\",\n//         status: \"üò• \" + err.message,\n//       };\n//     }\n//   } else {\n//     return {\n//       address: \"\",\n//       status: (\n//         <span>\n//           <p>\n//             {\" \"}\n//             ü¶ä{\" \"}\n//             <a target=\"_blank\" href={`https://metamask.io/download.html`}>\n//               You must install Metamask, a virtual Ethereum wallet, in your\n//               browser.\n//             </a>\n//           </p>\n//         </span>\n//       ),\n//     };\n//   }\n// };\nvar connectWallet=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(){var addressArray,obj;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:if(!window.ethereum){_context9.next=17;break;}_context9.prev=1;_context9.next=4;return window.ethereum.request({method:\"eth_requestAccounts\"});case 4:addressArray=_context9.sent;obj={status:\"üëÜüèΩ Enter any Teslo car plate no. above to reserve!\",regStatus:\"üëÜüèΩ Register first to start car sharing!\",address:addressArray[0]};setStatus(obj.status);setRegStatus(obj.regStatus);setWallet(obj.address);return _context9.abrupt(\"return\",obj);case 12:_context9.prev=12;_context9.t0=_context9[\"catch\"](1);return _context9.abrupt(\"return\",{address:\"\",status:\"üò• \"+_context9.t0.message});case 15:_context9.next=18;break;case 17:return _context9.abrupt(\"return\",{address:\"\",status:React.createElement(\"span\",null,React.createElement(\"p\",null,\" \",\"\\uD83E\\uDD8A\",\" \",React.createElement(\"a\",{target:\"_blank\",href:\"https://metamask.io/download.html\"},\"You must install Metamask, a virtual Ethereum wallet, in your browser.\")))});case 18:case\"end\":return _context9.stop();}}},_callee9,null,[[1,12]]);}));return function connectWallet(){return _ref9.apply(this,arguments);};}();// const inputChanged = (e) => {\n//   this.setState({ inputVal: e.target.value });\n// }\nvar connectWalletPressed=/*#__PURE__*/function(){var _ref10=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(){return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.next=2;return connectWallet().then(function(response){getUserStatus(response.address);},function(error){/**\n   * Handle error here\n   */});case 2:;case 3:case\"end\":return _context10.stop();}}},_callee10);}));return function connectWalletPressed(){return _ref10.apply(this,arguments);};}();// if (!this.state.web3) {\n//   return <div>Loading Web3, accounts, and contract...</div>;\n// }\nreturn React.createElement(\"div\",{id:\"container\"},React.createElement(\"button\",{id:\"walletButton\",onClick:connectWalletPressed},walletAddress.length>0?\"Connected: \"+String(walletAddress).substring(0,6)+\"...\"+String(walletAddress).substring(38):React.createElement(\"span\",null,\"Connect Wallet\")),React.createElement(\"h1\",{style:{paddingTop:\"50px\"}},\"Teslo Car Sharing Service\"),React.createElement(\"p\",{id:\"registrationStatus\"},registrationStatus),React.createElement(\"p\",{id:\"rentStatus\"},rentStatus),React.createElement(\"p\",null,message),React.createElement(\"div\",null,React.createElement(\"h3\",{style:{paddingTop:\"18px\"}},\"User Registration\"),React.createElement(\"h4\",{style:{paddingTop:\"18px\"}},\"Name:\"),React.createElement(\"input\",{type:\"text\",placeholder:\"e.g. John Wick\",onChange:function onChange(e){return setUserName(e.target.value);},value:userName}),React.createElement(\"h4\",{style:{paddingTop:\"18px\"}},\"License:\"),React.createElement(\"input\",{type:\"text\",placeholder:\"e.g. ID12345\",onChange:function onChange(e){return setLicense(e.target.value);},value:license}),React.createElement(\"p\",{id:\"status\"},regStatus)),React.createElement(\"button\",{id:\"publish\",style:{float:\"right\"},onClick:registerUser},\"Register\"),React.createElement(\"div\",null,React.createElement(\"h3\",{style:{paddingTop:\"18px\"}},\"Car Reservation\"),React.createElement(\"h4\",{style:{paddingTop:\"18px\"}},\"Plate No.:\"),React.createElement(\"input\",{type:\"text\",placeholder:\"e.g. SJW1011E\",onChange:function onChange(e){return setPlateNo(e.target.value);},value:plateNo})),React.createElement(\"button\",{id:\"publish\",style:{float:\"right\"},onClick:rentCar},\"Reserve\"),React.createElement(\"button\",{id:\"publish\",style:{float:\"right\"},onClick:unrentCar},\"Release\"),React.createElement(\"p\",{id:\"status\"},status));};export default App;","map":{"version":3,"sources":["/Users/elijahchen/blockchain-developer-bootcamp/blockchain-developer-bootcamp-final-project/client/src/App.js"],"names":["React","Component","useEffect","useState","SimpleStorageContract","CarSharingContract","getWeb3","App","message","setMessage","walletAddress","setWallet","status","setStatus","regStatus","setRegStatus","registrationStatus","setRegistrationStatus","rentStatus","setRentStatus","userRegistered","setUserRegistered","userRented","setUserRented","contract","setContract","content","setContent","userName","setUserName","license","setLicense","plateNo","setPlateNo","whenWalletConnected","web3","eth","getAccounts","accounts","net","getId","networkId","deployedNetwork","networks","instance","Contract","abi","address","events","UserRegistered","error","data","CarReserved","CarReleased","componentDidMount","alert","setState","console","runExample","state","methods","set","send","from","get","call","response","storageValue","rentCar","unrentCar","registerUser","registerDriver","getUserStatus","getRegistrationStatus","getRentStatus","connectWallet","window","ethereum","request","method","addressArray","obj","connectWalletPressed","then","length","String","substring","paddingTop","e","target","value","float"],"mappings":"2iBAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OAASC,SAAT,CAAoBC,QAApB,KAAoC,OAApC,CACA,MAAOC,CAAAA,qBAAP,KAAkC,gCAAlC,CACA,MAAOC,CAAAA,kBAAP,KAA+B,6BAA/B,CACA,MAAOC,CAAAA,OAAP,KAAoB,WAApB,CACA,MAAO,WAAP,CAEA,GAAMC,CAAAA,GAAG,CAAG,QAANA,CAAAA,GAAM,EAAM,eAEcJ,QAAQ,CAAC,EAAD,CAFtB,wCAETK,OAFS,eAEAC,UAFA,eAE4B;AAF5B,eAGmBN,QAAQ,CAAC,EAAD,CAH3B,yCAGTO,aAHS,eAGMC,SAHN,8BAIYR,QAAQ,CAAC,EAAD,CAJpB,yCAITS,MAJS,eAIDC,SAJC,8BAKkBV,QAAQ,CAAC,EAAD,CAL1B,yCAKTW,SALS,eAKEC,YALF,8BAMoCZ,QAAQ,CAAC,oBAAD,CAN5C,0CAMTa,kBANS,gBAMWC,qBANX,gCAOoBd,QAAQ,CAAC,iBAAD,CAP5B,2CAOTe,UAPS,gBAOGC,aAPH,gCAQ4BhB,QAAQ,CAAC,GAAD,CARpC,2CAQTiB,cARS,gBAQOC,iBARP,gCASoBlB,QAAQ,CAAC,GAAD,CAT5B,2CASTmB,UATS,gBASGC,aATH,gCAUgBpB,QAAQ,CAAC,EAAD,CAVxB,2CAUTqB,QAVS,gBAUCC,WAVD,gCAWctB,QAAQ,CAAC,MAAD,CAXtB,2CAWTuB,OAXS,gBAWAC,UAXA,gCAYgBxB,QAAQ,CAAC,EAAD,CAZxB,2CAYTyB,QAZS,gBAYCC,WAZD,gCAac1B,QAAQ,CAAC,EAAD,CAbtB,2CAaT2B,OAbS,gBAaAC,UAbA,gCAcc5B,QAAQ,CAAC,EAAD,CAdtB,2CAcT6B,OAdS,gBAcAC,UAdA,gBAehB;AAEA/B,SAAS,sEAAC,yJACFgC,CAAAA,mBAAmB,EADjB,uDAAD,GAKN,EALM,CAAT,CAOA,GAAMA,CAAAA,mBAAmB,2FAAG,oNACL5B,CAAAA,OAAO,EADF,QAClB6B,IADkB,uCAIDA,CAAAA,IAAI,CAACC,GAAL,CAASC,WAAT,EAJC,QAIlBC,QAJkB,uCAKAH,CAAAA,IAAI,CAACC,GAAL,CAASG,GAAT,CAAaC,KAAb,EALA,QAKlBC,SALkB,gBAMlBC,eANkB,CAMArC,kBAAkB,CAACsC,QAAnB,CAA4BF,SAA5B,CANA,CAOlBG,QAPkB,CAOP,GAAIT,CAAAA,IAAI,CAACC,GAAL,CAASS,QAAb,CACfxC,kBAAkB,CAACyC,GADJ,CAEfJ,eAAe,EAAIA,eAAe,CAACK,OAFpB,CAPO,CAWxBtB,WAAW,CAACmB,QAAD,CAAX,CACA;AACA;AACA;AAEAA,QAAQ,CAACI,MAAT,CAAgBC,cAAhB,CAA+B,EAA/B,CAAmC,SAACC,KAAD,CAAQC,IAAR,CAAiB,CAClD,GAAID,KAAJ,CAAW,CACTzC,UAAU,CAACyC,KAAK,CAAC1C,OAAP,CAAV,CACD,CAFD,IAEM,CACJS,qBAAqB,CAAC,oBAAD,CAArB,CACAI,iBAAiB,CAAC,GAAD,CAAjB,CACD,CACF,CAPD,EASAuB,QAAQ,CAACI,MAAT,CAAgBI,WAAhB,CAA4B,EAA5B,CAAgC,SAACF,KAAD,CAAQC,IAAR,CAAiB,CAC/C,GAAID,KAAJ,CAAW,CACTzC,UAAU,CAACyC,KAAK,CAAC1C,OAAP,CAAV,CACD,CAFD,IAEM,CACJW,aAAa,CAAC,iBAAD,CAAb,CACAI,aAAa,CAAC,GAAD,CAAb,CACD,CACF,CAPD,EASAqB,QAAQ,CAACI,MAAT,CAAgBK,WAAhB,CAA4B,EAA5B,CAAgC,SAACH,KAAD,CAAQC,IAAR,CAAiB,CAC/C,GAAID,KAAJ,CAAW,CACTzC,UAAU,CAACyC,KAAK,CAAC1C,OAAP,CAAV,CACD,CAFD,IAEM,CACJW,aAAa,CAAC,iBAAD,CAAb,CACD,CACF,CAND,EAlCwB,yDAAH,kBAAnBe,CAAAA,mBAAmB,2CAAzB,CA2CA,GAAMoB,CAAAA,iBAAiB,2FAAG,qOAGHhD,CAAAA,OAAO,EAHJ,QAGhB6B,IAHgB,uCAMCA,CAAAA,IAAI,CAACC,GAAL,CAASC,WAAT,EAND,QAMhBC,QANgB,uCAgBEH,CAAAA,IAAI,CAACC,GAAL,CAASG,GAAT,CAAaC,KAAb,EAhBF,QAgBhBC,SAhBgB,gBAiBhBC,eAjBgB,CAiBErC,kBAAkB,CAACsC,QAAnB,CAA4BF,SAA5B,CAjBF,CAkBhBG,QAlBgB,CAkBL,GAAIT,CAAAA,IAAI,CAACC,GAAL,CAASS,QAAb,CACfxC,kBAAkB,CAACyC,GADJ,CAEfJ,eAAe,EAAIA,eAAe,CAACK,OAFpB,CAlBK,CAuBtB;AACA;AACA;AAEAH,QAAQ,CAACI,MAAT,CAAgBC,cAAhB,CAA+B,EAA/B,CAAmC,SAACC,KAAD,CAAQC,IAAR,CAAiB,CAClD,GAAID,KAAJ,CAAW,CACTK,KAAK,CAACL,KAAK,CAAC1C,OAAP,CAAL,CACD,CAFD,IAEM,CACJ,KAAI,CAACgD,QAAL,CAAc,CAAExC,kBAAkB,CAAE,oBAAtB,CAAd,EACD,CAEF,CAPD,EA3BsB,qFAoCtB;AACAuC,KAAK,0EAAL,CAGAE,OAAO,CAACP,KAAR,eAxCsB,uEAAH,kBAAjBI,CAAAA,iBAAiB,2CAAvB,CA4CA,GAAMI,CAAAA,UAAU,2FAAG,+LACc,KAAI,CAACC,KADnB,CACTrB,QADS,aACTA,QADS,CACCd,QADD,aACCA,QADD,CAGjB;AAHiB,uBAIXA,CAAAA,QAAQ,CAACoC,OAAT,CAAiBC,GAAjB,CAAqB,CAArB,EAAwBC,IAAxB,CAA6B,CAAEC,IAAI,CAAEzB,QAAQ,CAAC,CAAD,CAAhB,CAA7B,CAJW,+BAOMd,CAAAA,QAAQ,CAACoC,OAAT,CAAiBI,GAAjB,GAAuBC,IAAvB,EAPN,QAOXC,QAPW,gBASjB;AACA,KAAI,CAACV,QAAL,CAAc,CAAEW,YAAY,CAAED,QAAhB,CAAd,EAViB,wDAAH,kBAAVR,CAAAA,UAAU,2CAAhB,CAaD,GAAMU,CAAAA,OAAO,2FAAG,+JACV5C,CAAAA,QAAQ,CAACoC,OAAT,CAAiBQ,OAAjB,CAAyB,EAAzB,CAA6BpC,OAA7B,EAAsC8B,IAAtC,CAA2C,CAAEC,IAAI,CAAErD,aAAR,CAA3C,CADU,yDAAH,kBAAP0D,CAAAA,OAAO,2CAAb,CAID,GAAMC,CAAAA,SAAS,2FAAG,+JACV7C,CAAAA,QAAQ,CAACoC,OAAT,CAAiBS,SAAjB,CAA2BrC,OAA3B,EAAoC8B,IAApC,CAAyC,CAAEC,IAAI,CAAErD,aAAR,CAAzC,CADU,yDAAH,kBAAT2D,CAAAA,SAAS,2CAAf,CAIA,GAAMC,CAAAA,YAAY,2FAAG,6IAChBlD,cAAc,EAAI,GADF,kDAEXI,CAAAA,QAAQ,CAACoC,OAAT,CAAiBW,cAAjB,CAAgC3C,QAAhC,CAA0CE,OAA1C,EAAmDgC,IAAnD,CAAwD,CAAEC,IAAI,CAAErD,aAAR,CAAxD,CAFW,sCAIjBK,YAAY,CAAC,6BAAD,CAAZ,CAJiB,wDAAH,kBAAZuD,CAAAA,YAAY,2CAAlB,CASA,GAAME,CAAAA,aAAa,2FAAG,kBAAOzB,OAAP,0JACCvB,CAAAA,QAAQ,CAACoC,OAAT,CAAiBa,qBAAjB,CAAuC1B,OAAvC,EAAgDkB,IAAhD,EADD,QAChBC,QADgB,gBAEpB,GAAGA,QAAH,CAAY,CACVjD,qBAAqB,CAAC,oBAAD,CAArB,CACAI,iBAAiB,CAAC,GAAD,CAAjB,CACD,CAHD,IAGK,CACHJ,qBAAqB,CAAC,oBAAD,CAArB,CACAU,UAAU,CAAC,QACR,2DADQ,CAER,gDAFQ,CAGR,WAHQ,CAIR,kBAJQ,CAKR,mCALQ,CAMR,OANQ,CAOR,oDAPQ,CAQR,WARQ,CASR,kBATQ,CAUR,iCAVQ,CAWR,OAXQ,CAaR,UAbQ,CAcR,kDAdQ,CAeR,eAfQ,CAgBR,cAhBO,CAAV,CAiBD,CAxBmB,uBA0BHH,CAAAA,QAAQ,CAACoC,OAAT,CAAiBc,aAAjB,CAA+B3B,OAA/B,EAAwCkB,IAAxC,EA1BG,QA0BpBC,QA1BoB,gBA2BpB,GAAGA,QAAH,CAAY,CACV/C,aAAa,CAAC,iBAAD,CAAb,CACD,CAFD,IAEK,CACHA,aAAa,CAAC,iBAAD,CAAb,CACD,CA/BmB,wDAAH,kBAAbqD,CAAAA,aAAa,6CAAnB,CAmCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,GAAMG,CAAAA,aAAa,2FAAG,iKAChBC,MAAM,CAACC,QADS,mEAGWD,CAAAA,MAAM,CAACC,QAAP,CAAgBC,OAAhB,CAAwB,CACjDC,MAAM,CAAE,qBADyC,CAAxB,CAHX,QAGVC,YAHU,gBAMVC,GANU,CAMJ,CACVrE,MAAM,CAAE,sDADE,CAEVE,SAAS,CAAE,2CAFD,CAGViC,OAAO,CAAEiC,YAAY,CAAC,CAAD,CAHX,CANI,CAWhBnE,SAAS,CAACoE,GAAG,CAACrE,MAAL,CAAT,CACAG,YAAY,CAACkE,GAAG,CAACnE,SAAL,CAAZ,CACAH,SAAS,CAACsE,GAAG,CAAClC,OAAL,CAAT,CAbgB,iCAcTkC,GAdS,gGAgBT,CACLlC,OAAO,CAAE,EADJ,CAELnC,MAAM,CAAE,MAAQ,aAAIJ,OAFf,CAhBS,2EAsBX,CACLuC,OAAO,CAAE,EADJ,CAELnC,MAAM,CACJ,gCACE,6BACG,GADH,gBAEK,GAFL,CAGE,yBAAG,MAAM,CAAC,QAAV,CAAmB,IAAI,oCAAvB,2EAHF,CADF,CAHG,CAtBW,yEAAH,kBAAb+D,CAAAA,aAAa,2CAAnB,CAyCA;AACA;AACA;AAEA,GAAMO,CAAAA,oBAAoB,4FAAG,qKACtBP,CAAAA,aAAa,GAAGQ,IAAhB,CAAqB,SAACjB,QAAD,CAAc,CACxCM,aAAa,CAACN,QAAQ,CAACnB,OAAV,CAAb,CACD,CAFM,CAEJ,SAACG,KAAD,CAAW,CACZ;;KAGD,CANM,CADsB,QAO1B,CAP0B,0DAAH,kBAApBgC,CAAAA,oBAAoB,4CAA1B,CAUI;AACA;AACA;AACA,MACE,4BAAK,EAAE,CAAC,WAAR,EAEA,8BAAQ,EAAE,CAAC,cAAX,CAA0B,OAAO,CAAEA,oBAAnC,EACGxE,aAAa,CAAC0E,MAAd,CAAuB,CAAvB,CACC,cACAC,MAAM,CAAC3E,aAAD,CAAN,CAAsB4E,SAAtB,CAAgC,CAAhC,CAAmC,CAAnC,CADA,CAEA,KAFA,CAGAD,MAAM,CAAC3E,aAAD,CAAN,CAAsB4E,SAAtB,CAAgC,EAAhC,CAJD,CAMC,iDAPJ,CAFA,CAaA,0BAAI,KAAK,CAAE,CAAEC,UAAU,CAAE,MAAd,CAAX,8BAbA,CAcE,yBAAG,EAAE,CAAC,oBAAN,EAA4BvE,kBAA5B,CAdF,CAeE,yBAAG,EAAE,CAAC,YAAN,EAAoBE,UAApB,CAfF,CAgBE,6BAAIV,OAAJ,CAhBF,CAiBA,+BACE,0BAAI,KAAK,CAAE,CAAE+E,UAAU,CAAE,MAAd,CAAX,sBADF,CAEE,0BAAI,KAAK,CAAE,CAAEA,UAAU,CAAE,MAAd,CAAX,UAFF,CAGD,6BACG,IAAI,CAAC,MADR,CAEG,WAAW,CAAC,gBAFf,CAGG,QAAQ,CAAE,kBAACC,CAAD,QAAO3D,CAAAA,WAAW,CAAC2D,CAAC,CAACC,MAAF,CAASC,KAAV,CAAlB,EAHb,CAIG,KAAK,CAAE9D,QAJV,EAHC,CASD,0BAAI,KAAK,CAAE,CAAE2D,UAAU,CAAE,MAAd,CAAX,aATC,CAUA,6BACE,IAAI,CAAC,MADP,CAEE,WAAW,CAAC,cAFd,CAGE,QAAQ,CAAE,kBAACC,CAAD,QAAOzD,CAAAA,UAAU,CAACyD,CAAC,CAACC,MAAF,CAASC,KAAV,CAAjB,EAHZ,CAIE,KAAK,CAAE5D,OAJT,EAVA,CAgBC,yBAAG,EAAE,CAAC,QAAN,EAAgBhB,SAAhB,CAhBD,CAjBA,CAmCD,8BAAQ,EAAE,CAAC,SAAX,CAAqB,KAAK,CAAE,CAAE6E,KAAK,CAAE,OAAT,CAA5B,CAA+C,OAAO,CAAErB,YAAxD,aAnCC,CAwCD,+BACG,0BAAI,KAAK,CAAE,CAAEiB,UAAU,CAAE,MAAd,CAAX,oBADH,CAEG,0BAAI,KAAK,CAAE,CAAEA,UAAU,CAAE,MAAd,CAAX,eAFH,CAGA,6BACG,IAAI,CAAC,MADR,CAEG,WAAW,CAAC,eAFf,CAGG,QAAQ,CAAE,kBAACC,CAAD,QAAOvD,CAAAA,UAAU,CAACuD,CAAC,CAACC,MAAF,CAASC,KAAV,CAAjB,EAHb,CAIG,KAAK,CAAE1D,OAJV,EAHA,CAxCC,CAkDD,8BAAQ,EAAE,CAAC,SAAX,CAAqB,KAAK,CAAE,CAAE2D,KAAK,CAAE,OAAT,CAA5B,CAA+C,OAAO,CAAEvB,OAAxD,YAlDC,CAqDD,8BAAQ,EAAE,CAAC,SAAX,CAAqB,KAAK,CAAE,CAAEuB,KAAK,CAAE,OAAT,CAA5B,CAA+C,OAAO,CAAEtB,SAAxD,YArDC,CAwDC,yBAAG,EAAE,CAAC,QAAN,EAAgBzD,MAAhB,CAxDD,CADF,CA6DD,CAjVH,CAqVA,cAAeL,CAAAA,GAAf","sourcesContent":["import React, { Component } from \"react\";\nimport { useEffect, useState } from \"react\";\nimport SimpleStorageContract from \"./contracts/SimpleStorage.json\";\nimport CarSharingContract from \"./contracts/CarSharing.json\";\nimport getWeb3 from \"./getWeb3\";\nimport \"./App.css\";\n\nconst App = () => {\n  \n  const [message, setMessage] = useState(\"\"); //default message\n  const [walletAddress, setWallet] = useState(\"\");\n  const [status, setStatus] = useState(\"\");\n  const [regStatus, setRegStatus] = useState(\"\");\n  const [registrationStatus, setRegistrationStatus] = useState(\"User Registered üî¥\");\n  const [rentStatus, setRentStatus] = useState(\"Car Reserved üî¥\");\n  const [userRegistered, setUserRegistered] = useState(\"0\");\n  const [userRented, setUserRented] = useState(\"0\");\n  const [contract, setContract] = useState(\"\");\n  const [content, setContent] = useState(\"test\");\n  const [userName, setUserName] = useState(\"\");\n  const [license, setLicense] = useState(\"\");\n  const [plateNo, setPlateNo] = useState(\"\");\n  //state = { message: null, userName: null, userId: null, rentStatus: null, web3: null, accounts: null, contract: null };\n\n  useEffect(async () => {\n    await whenWalletConnected();\n    // const message = \"hello\";\n    // setMessage(message);\n    \n  }, []);\n\n  const whenWalletConnected = async () => {\n      const web3 = await getWeb3();\n\n      // Use web3 to get the user's accounts.\n      const accounts = await web3.eth.getAccounts();\n      const networkId = await web3.eth.net.getId();\n      const deployedNetwork = CarSharingContract.networks[networkId];\n      const instance = new web3.eth.Contract(\n        CarSharingContract.abi,\n        deployedNetwork && deployedNetwork.address,\n      );\n      setContract(instance);\n      // Set web3, accounts, and contract to the state, and then proceed with an\n      // example of interacting with the contract's methods.\n      //this.setState({ web3, accounts, contract: instance }, this.startApp);\n\n      instance.events.UserRegistered({}, (error, data) => {\n        if (error) {\n          setMessage(error.message);\n        } else{\n          setRegistrationStatus(\"User Registered üü¢\");\n          setUserRegistered(\"1\");\n        }\n      });\n\n      instance.events.CarReserved({}, (error, data) => {\n        if (error) {\n          setMessage(error.message);\n        } else{\n          setRentStatus(\"Car Reserved üü¢\");\n          setUserRented(\"1\");\n        }\n      });\n\n      instance.events.CarReleased({}, (error, data) => {\n        if (error) {\n          setMessage(error.message);\n        } else{\n          setRentStatus(\"Car Reserved üî¥\");\n        }\n      });\n  };\n\n  const componentDidMount = async () => {\n    try {\n      // Get network provider and web3 instance.\n      const web3 = await getWeb3();\n\n      // Use web3 to get the user's accounts.\n      const accounts = await web3.eth.getAccounts();\n\n      // Get the contract instance.\n      // const networkId = await web3.eth.net.getId();\n      // const deployedNetwork = SimpleStorageContract.networks[networkId];\n      // const instance = new web3.eth.Contract(\n      //   SimpleStorageContract.abi,\n      //   deployedNetwork && deployedNetwork.address,\n      // );\n\n      const networkId = await web3.eth.net.getId();\n      const deployedNetwork = CarSharingContract.networks[networkId];\n      const instance = new web3.eth.Contract(\n        CarSharingContract.abi,\n        deployedNetwork && deployedNetwork.address,\n      );\n\n      // Set web3, accounts, and contract to the state, and then proceed with an\n      // example of interacting with the contract's methods.\n      //this.setState({ web3, accounts, contract: instance }, this.startApp);\n\n      instance.events.UserRegistered({}, (error, data) => {\n        if (error) {\n          alert(error.message);\n        } else{\n          this.setState({ registrationStatus: \"You are registered\"});\n        }\n        \n      });\n    } catch (error) {\n      // Catch any errors for any of the above operations.\n      alert(\n        `Failed to load web3, accounts, or contract. Check console for details.`,\n      );\n      console.error(error);\n    }\n  };\n\n  const runExample = async () => {\n    const { accounts, contract } = this.state;\n\n    // Stores a given value, 5 by default.\n    await contract.methods.set(5).send({ from: accounts[0] });\n\n    // Get the value from the contract to prove it worked.\n    const response = await contract.methods.get().call();\n\n    // Update state with the result.\n    this.setState({ storageValue: response });\n  };\n\n const rentCar = async () => {\n await contract.methods.rentCar(10, plateNo).send({ from: walletAddress });\n};\n\nconst unrentCar = async () => {\n  await contract.methods.unrentCar(plateNo).send({ from: walletAddress });\n };\n\nconst registerUser = async () => {\n  if(userRegistered == \"0\"){\n    await contract.methods.registerDriver(userName, license).send({ from: walletAddress });\n  }else{\n    setRegStatus(\"You are already registered!\");\n  }\n  \n};\n\nconst getUserStatus = async (address) => {\n  let response = await contract.methods.getRegistrationStatus(address).call();\n  if(response){\n    setRegistrationStatus(\"User Registered üü¢\");\n    setUserRegistered(\"1\");\n  }else{\n    setRegistrationStatus(\"User Registered üî¥\");\n    setContent('<div>' \n     + '<h3 style={{ paddingTop: \"18px\" }}>User Registration</h3>'\n     + ' <h3 style={{ paddingTop: \"18px\" }}>Name:</h3>'\n     + '   <input'\n     + '     type=\"text\"'\n     + '     placeholder=\"e.g. John Wick\"'\n     + '   />'\n     + '  <h3 style={{ paddingTop: \"18px\" }}>License:</h3>'\n     + '   <input'\n     + '     type=\"text\"'\n     + '     placeholder=\"e.g. ID12345\"'\n     + '   />'\n       \n     + ' </div> '\n     + ' <button id=\"publish\" style={{ float: \"right\"}}>'\n     + '     Register'\n     + '   </button>');\n  }\n\n  response = await contract.methods.getRentStatus(address).call();\n  if(response){\n    setRentStatus(\"Car Reserved üü¢\");\n  }else{\n    setRentStatus(\"Car Reserved üî¥\");\n  }\n};\n\n\n// getCurrentWalletConnected = async () => {\n//   if (window.ethereum) {\n//     try {\n//       const addressArray = await window.ethereum.request({\n//         method: \"eth_accounts\",\n//       });\n//       if (addressArray.length > 0) {\n//         return {\n//           address: addressArray[0],\n//           status: \"üëÜüèΩ Write a message in the text-field above.\",\n//         };\n//       } else {\n//         return {\n//           address: \"\",\n//           status: \"ü¶ä Connect to Metamask using the top right button.\",\n//         };\n//       }\n//     } catch (err) {\n//       return {\n//         address: \"\",\n//         status: \"üò• \" + err.message,\n//       };\n//     }\n//   } else {\n//     return {\n//       address: \"\",\n//       status: (\n//         <span>\n//           <p>\n//             {\" \"}\n//             ü¶ä{\" \"}\n//             <a target=\"_blank\" href={`https://metamask.io/download.html`}>\n//               You must install Metamask, a virtual Ethereum wallet, in your\n//               browser.\n//             </a>\n//           </p>\n//         </span>\n//       ),\n//     };\n//   }\n// };\n\nconst connectWallet = async () => {\n  if (window.ethereum) {\n    try {\n      const addressArray = await window.ethereum.request({\n        method: \"eth_requestAccounts\",\n      });\n      const obj = {\n        status: \"üëÜüèΩ Enter any Teslo car plate no. above to reserve!\",\n        regStatus: \"üëÜüèΩ Register first to start car sharing!\",\n        address: addressArray[0],\n      };\n      setStatus(obj.status);\n      setRegStatus(obj.regStatus)\n      setWallet(obj.address);\n      return obj;\n    } catch (err) {\n      return {\n        address: \"\",\n        status: \"üò• \" + err.message,\n      };\n    }\n  } else {\n    return {\n      address: \"\",\n      status: (\n        <span>\n          <p>\n            {\" \"}\n            ü¶ä{\" \"}\n            <a target=\"_blank\" href={`https://metamask.io/download.html`}>\n              You must install Metamask, a virtual Ethereum wallet, in your\n              browser.\n            </a>\n          </p>\n        </span>\n      ),\n    };\n  }\n  \n};  \n\n// const inputChanged = (e) => {\n//   this.setState({ inputVal: e.target.value });\n// }\n  \nconst connectWalletPressed = async () => {\n await connectWallet().then((response) => {\n  getUserStatus(response.address);\n}, (error) => {\n  /**\n   * Handle error here\n   */\n});;\n};\n\n    // if (!this.state.web3) {\n    //   return <div>Loading Web3, accounts, and contract...</div>;\n    // }\n    return (\n      <div id=\"container\">\n      {/* <img id=\"logo\" src={alchemylogo}></img> */}\n      <button id=\"walletButton\" onClick={connectWalletPressed}>\n        {walletAddress.length > 0 ? (\n          \"Connected: \" +\n          String(walletAddress).substring(0, 6) +\n          \"...\" +\n          String(walletAddress).substring(38)\n        ) : (\n          <span>Connect Wallet</span>\n        )}\n      </button>\n\n      <h1 style={{ paddingTop: \"50px\" }}>Teslo Car Sharing Service</h1>\n        <p id=\"registrationStatus\">{registrationStatus}</p>\n        <p id=\"rentStatus\">{rentStatus}</p>\n        <p>{message}</p>\n      <div> \n        <h3 style={{ paddingTop: \"18px\" }}>User Registration</h3>\n        <h4 style={{ paddingTop: \"18px\" }}>Name:</h4>\n     <input\n        type=\"text\"\n        placeholder=\"e.g. John Wick\"\n        onChange={(e) => setUserName(e.target.value)}\n        value={userName}\n     />\n     <h4 style={{ paddingTop: \"18px\" }}>License:</h4>\n      <input\n        type=\"text\"\n        placeholder=\"e.g. ID12345\"\n        onChange={(e) => setLicense(e.target.value)}\n        value={license}\n      />\n       <p id=\"status\">{regStatus}</p>\n     </div> \n     <button id=\"publish\" style={{ float: \"right\"}} onClick={registerUser}>\n        Register\n     </button>\n\n\n     <div> \n        <h3 style={{ paddingTop: \"18px\" }}>Car Reservation</h3>\n        <h4 style={{ paddingTop: \"18px\" }}>Plate No.:</h4>\n     <input\n        type=\"text\"\n        placeholder=\"e.g. SJW1011E\"\n        onChange={(e) => setPlateNo(e.target.value)}\n        value={plateNo}\n     />\n     </div> \n     <button id=\"publish\" style={{ float: \"right\"}} onClick={rentCar}>\n        Reserve\n     </button>\n     <button id=\"publish\" style={{ float: \"right\"}} onClick={unrentCar}>\n        Release\n     </button>\n       <p id=\"status\">{status}</p>\n       \n    </div>\n    );\n  };\n\n\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}